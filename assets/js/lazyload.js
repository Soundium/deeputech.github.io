!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.lazyLoad=t()}(this,function(){var a,r,i,d,l,c={pageUpdatedEventName:"page:updated",elements:"img[data-src], img[data-srcset], source[data-srcset], iframe[data-src], video[data-src], [data-lazyload]",rootMargin:"0px",threshold:0,maxFrameCount:10},s=[];function u(e){e.removeAttribute("data-src"),e.removeAttribute("data-srcset"),e.removeAttribute("data-lazyload")}function m(){this.removeEventListener("load",m),u(this)}function f(e){var t=e.getAttribute("data-srcset"),n=e.getAttribute("data-src"),o=null!==e.getAttribute("data-lazyload");t&&(e.setAttribute("srcset",t),window.picturefill&&window.picturefill({elements:[e]})),n&&(e.src=n),o&&(e.setAttribute("data-lazyloaded",""),e.removeEventListener("load",m),u(e))}function v(e){0===i&&d.disconnect();for(var t=0;t<e.length;t++){var n=e[t];0<n.intersectionRatio&&(i--,d.unobserve(n.target),n.target.addEventListener("load",m,!1),f(n.target))}}function g(){var e,t,n;if("really-old"===l){for(i=s.length,e=0;e<i;e++)s[e]&&(f(s[e]),u(s[e]));s=[]}else if("old"===l){if(r===c.maxFrameCount){for(i=s.length,e=0;e<i;e++)if(s[e]&&void 0===s[e].lazyloaded&&(t=s[e],void 0,0<(n=(t="SOURCE"===t.tagName?t.parentNode:t).getBoundingClientRect()).bottom&&0<n.right&&n.left<(window.innerWidth||document.documentElement.clientWidth)&&n.top<(window.innerHeight||document.documentElement.clientHeight))){var o=s[e];s[e]=void 0,o.lazyloaded=!0,o.addEventListener("load",m,!1),f(o)}for(e=0;e<i;e++)void 0===s[e]&&s.splice(e,1);i=s.length,r=-1}0<i&&(r++,a=window.requestAnimationFrame(g))}else if("new"===l)for(d=new IntersectionObserver(v,{rootMargin:c.rootMargin,threshold:c.threshold}),i=s.length,e=0;e<i;e++)s[e]&&void 0===s[e].lazyloaded&&d.observe(s[e])}function n(){if("old"===l)try{cancelAnimationFrame(a)}catch(e){}else if("new"===l)try{d.disconnect()}catch(e){}s=function(e){var t=[],n=0;for(t=[],n=e.length;n;)t[--n]=e[n];return t}(document.querySelectorAll(c.elements)),i=s.length,r=c.maxFrameCount,g()}return function(e){for(var t in e)e.hasOwnProperty(t)&&(c[t]=e[t]);l="addEventListener"in window&&window.requestAnimationFrame&&void 0!==typeof document.body.getBoundingClientRect?"IntersectionObserver"in window?"new":"old":"really-old",n(),c.pageUpdatedEventName&&document.addEventListener(c.pageUpdatedEventName,n,!0)}}),lazyLoad();